<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Espruino</title>
  <style>
    table {
      border-collapse: collapse;
    }

    table,
    td,
    th {
      border: 1px solid black;
    }
  </style>
</head>

<body>
  <h2>Connecting to Espruino</h2>
  <p>

    Troubleshoot:<br>
    <p>Sometimes, it helps to close Web IDE, open minicom (keep trying until no longer device busy message) hitreturn a
      few times. Then close minicom, open Web IDE and try connecting again.
    </p>
    <p>
      If that doesn't help, try<br>
      <code>sudo minicom</code><br>
      After that, it may connect as regular user again.
    </p>
    <h2>Autostart Code</h2>

    When the project is deployed, we want the code to start when the Espruino is powered on.<br>

    <h3>Code structure</h3>
    Espruino is designed such that the following function will be run automatically after start:</br>
    <code>function onInit() {</br>
      ..<br>
      }</code><br>

    so add this function to your code and place a call to your function inside<br>
    <h3>Save your code in Flash</h3>

    Save code in Flash so that it is available after powerup:<br>
    run<br>
    <code>save();</code><br>

    <h3>Save Modules in Flash</h3>

Make sure firmware is at least 2.0. <br>
    In the Web IDE, set the following options:<br>
    Modules uploaded as Functions<br>

    Do not check "Save on Send Direct to Flash" because this may cause problems with code
    staying in Flash that should not be there. (See Troubleshooting)<br>


    <a href="images/EspruinosettingsSaveCode.png"> <img src="images/EspruinosettingsSaveCode.png" width="600" alt=""></a>



    <h2>Run Espruino directly from Battery or through Buck Converter?</h2>
    <img src="images/EspruinoWifiTopPower.jpg" width="486" height="481" alt=""><br>
    <p>
      Supply voltage from one battery directly to Espruino:
      <table>
        <tr>
          <td>U</td>
          <td>P</td>
        </tr>
        <tr>
          <td>3.7 V</td>
          <td>0.09 W</td>
        </tr>
        <tr>
          <td>4.2 V</td>
          <td>0.12 W</td>
        </tr>
      </table>
    </p>
    <p>
      Supply voltage from batteries through Buck Converter 1 to Espruino:<br>
      <img src="images/RioRand.png" width="434" height="213" alt="">
      <table>
        <tr>
          <td>U in</td>
          <td>U out</td>
          <td>P</td>
        </tr>
        <tr>
          <td>8.0 V</td>
          <td>3.3 V</td>
          <td>0.15 W</td>
        </tr>
        <tr>
          <td>4.0 V</td>
          <td>3.3 V</td>
          <td>0.18 W</td>
        </tr>
      </table>
    </p>

    <p>
      Supply voltage from batteries through Buck Converter 2 to Espruino:<br>
      <img src="images/" width="434" alt="">
      <table>
        <tr>
          <td>U in</td>
          <td>U out</td>
          <td>P</td>
        </tr>
        <tr>
          <td>8.0 V</td>
          <td>3.3 V</td>
          <td>0.09 W</td>
        </tr>
      </table>
    </p>
    <p>
      Supply voltage from batteries through Buck Converter 3 to Espruino:<br>
      (with power LED on)<br>
      <a href="https://www.amazon.com/gp/product/B07C2QF1T1"> <img src="images/buck3.jpg" width="400" alt=""></a>
      <table>
        <tr>
          <td>U in</td>
          <td>U out</td>
          <td>P</td>
        </tr>
        <tr>
          <td>8.0 V</td>
          <td>3.3 V</td>
          <td>0.10 W</td>
        </tr>
      </table>
    </p>





    <h2>Useful commands in Web-IDE</h2>
    <p>
      Reset Espruino:<br>
      run<br>
      <code>reset();</code><br>
    </p>

    <p>
      Remove modules from Flash:<br>
      run<br>
      <code>reset();</code><br>
      <code>save();</code><br>
      or may have to use<br>
      E.setBootCode()<br>
      <a href="http://forum.espruino.com/conversations/256465/">http://forum.espruino.com/conversations/256465/</a>
    </p>



    <h2>Load Modules from disk</h2>
    <p>
      http://forum.espruino.com/conversations/286424/
    </p>


    <h2>SD Cards</h2>
    <p>

      <a href="https://www.espruino.com/File+IO" target="https://www.espruino.com/File+IO">https://www.espruino.com/File+IO</a><br>

      Method 1: Solder Micro SD adapter to wires<br>
      <img src="images/File_IO_wiring2.jpg" width="600" height="450" alt=""><br>

      Method 2: Use Micro SD breakout board<br>
      <img src="images/AdadfruitSDcardBoard.jpg" width="726" height="560" alt=""><br>
      <a href="https://www.adafruit.com/product/254" target="https://www.adafruit.com/product/254" name="https://www.adafruit.com/product/254"></a><br>

      Method 3: SD card connector on PCB<br>
      <img src="images/SDcardConnectorSMD.jpg" width="356" height="249" alt=""><br>
      (yes but it's SMD)<br>

      Method 4: SD card connector on breakout board without additional parts<br>
      <img src="images/MicroSDConnectorTHT.jpg" width="600" height="232" alt="">
      <br>


      <h2>Troubleshoot</h2>
      <h3>SD card reinsert</h3>
      <p>
        <a href="http://forum.espruino.com/conversations/253121/">http://forum.espruino.com/conversations/253121/</a>
      </p>

      <h3>Problems after save()</h3>
      <p>
        Error message:<br>
        <code>
          Uncaught SyntaxError: Got ?[255] expected EOF
          at line 1 col 1
          ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255]
          ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255] ?[255]
          ^
          in function called from system
        </code><br>
        <a href="http://forum.espruino.com/conversations/297591/" target="http://forum.espruino.com/conversations/297591/">http://forum.espruino.com/conversations/297591/</a>
      </p>
      to see what is in flash run<br>
      <code>dump()</code><br>
      To clear<br>
      <code>reset()</code><br>
      <code>E.setBootCode()</code><br>
      <code>save()</code><br>
      Then test with<br>
      <code>dump()</code><br>
      and change <br>
      Save on Send Direct to Flash<br>
      to<br>
      Save on Send To RAM (Default)<br>
      <h3>Program runs in Web IDE but stalls as stand-alone</h3>
      Remove console.log and print calls<br>
      <br>


  <h2>Which Espruino?</h2>
  
  Espruino Wifi- Wifi distorts PWM signal on A0 causing the buck converter to not function.<br>
  
Need an Espruino where the Wifi is not mounted to the Espruino.<br>

Pico?<br>
   Can be put into sleep mode with 0.02 mA power consumption<br>
   
<a href="http://forum.espruino.com/conversations/273005/" target="http://forum.espruino.com/conversations/273005/">http://forum.espruino.com/conversations/273005/</a>  <br>

Add Wifi:<br>
<a href="https://www.espruino.com/ESP8266">https://www.espruino.com/ESP8266</a><br>

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
.tg .tg-0lax{text-align:left;vertical-align:top}
</style>
<table class="tg">
  <tr>
    <th class="tg-0lax">Name</th>
    <th class="tg-0lax">CPU</th>
    <th class="tg-0lax">MHz</th>
    <th class="tg-0lax">Flash</th>
    <th class="tg-0lax">RAM</th>
    <th class="tg-0lax">PWM</th>
    <th class="tg-0lax">SPI</th>
    <th class="tg-0lax">I2C</th>
  </tr>
  <tr>
    <td class="tg-0lax">Espruino Wifi</td>
    <td class="tg-0lax">STM32F411CEU6</td>
    <td class="tg-0lax">100</td>
    <td class="tg-0lax">512KB</td>
    <td class="tg-0lax">128KB</td>
    <td class="tg-0lax">20</td>
    <td class="tg-0lax">3</td>
    <td class="tg-0lax">3</td>
  </tr>
  <tr>
    <td class="tg-0lax">Espruino Pico</td>
    <td class="tg-0lax">STM32F401CDU6</td>
    <td class="tg-0lax">84</td>
    <td class="tg-0lax">384kb</td>
    <td class="tg-0lax">96kb</td>
    <td class="tg-0lax">21</td>
    <td class="tg-0lax">3</td>
    <td class="tg-0lax">3</td>
  </tr>
  <tr>
    <td class="tg-0lax">Original</td>
    <td class="tg-0lax">STM32F103RCT6</td>
    <td class="tg-0lax">72</td>
    <td class="tg-0lax">256KB</td>
    <td class="tg-0lax">48KB</td>
    <td class="tg-0lax">26</td>
    <td class="tg-0lax">2</td>
    <td class="tg-0lax">2</td>
  </tr>
</table>
  <br>
  <br>
  <br>
  
  
  
  
  
  
  
  
  
  
</body>

</html>